<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>28 . 논문 품질 그래프 생성 | 데이터 과학을 지탱하는 기본기</title>
<meta name="author" content="한국 알 사용자회">
<meta name="description" content="데이터를 도식화하는 것이 변수간 다양한 관계를 재빨리 탐색하는 최상의 방식 중 하나다. R에는 세가지 주류 도식화 시스템이 존재한다: Base 도식화 시스템, lattice 팩키지, ggplot2 팩키지. 금일, ggplot2 팩키지를 학습할 것인데 이유는 논문 품질 그래프를 생성하는데 가장 효과적이기 때문이다. ggplot2는 그래픽...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="28 . 논문 품질 그래프 생성 | 데이터 과학을 지탱하는 기본기">
<meta property="og:type" content="book">
<meta property="og:description" content="데이터를 도식화하는 것이 변수간 다양한 관계를 재빨리 탐색하는 최상의 방식 중 하나다. R에는 세가지 주류 도식화 시스템이 존재한다: Base 도식화 시스템, lattice 팩키지, ggplot2 팩키지. 금일, ggplot2 팩키지를 학습할 것인데 이유는 논문 품질 그래프를 생성하는데 가장 효과적이기 때문이다. ggplot2는 그래픽...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="28 . 논문 품질 그래프 생성 | 데이터 과학을 지탱하는 기본기">
<meta name="twitter:description" content="데이터를 도식화하는 것이 변수간 다양한 관계를 재빨리 탐색하는 최상의 방식 중 하나다. R에는 세가지 주류 도식화 시스템이 존재한다: Base 도식화 시스템, lattice 팩키지, ggplot2 팩키지. 금일, ggplot2 팩키지를 학습할 것인데 이유는 논문 품질 그래프를 생성하는데 가장 효과적이기 때문이다. ggplot2는 그래픽...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-229551680-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-229551680-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">데이터 과학을 지탱하는 기본기</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">데이터 과학을 지탱하는 기본기</a></li>
<li class="book-part">자동화</li>
<li><a class="" href="shell-intro.html"><span class="header-section-number">1</span> 쉘(Shell) 소개</a></li>
<li><a class="" href="shell-filedir.html"><span class="header-section-number">2</span> 파일과 폴더 넘나들기</a></li>
<li><a class="" href="shell-create.html"><span class="header-section-number">3</span> 파일과 디렉토리 작업</a></li>
<li><a class="" href="pipe-filter.html"><span class="header-section-number">4</span> 파이프와 필터</a></li>
<li><a class="" href="shell-loop.html"><span class="header-section-number">5</span> 루프(Loops)</a></li>
<li><a class="" href="shell-script.html"><span class="header-section-number">6</span> 쉘 스크립트</a></li>
<li><a class="" href="shell-find.html"><span class="header-section-number">7</span> 파일, 문자, 디렉토리 등 찾기</a></li>
<li class="book-part">버전제어와 협업</li>
<li><a class="" href="git.html"><span class="header-section-number">8</span> 자동화된 버젼제어</a></li>
<li><a class="" href="git-setup.html"><span class="header-section-number">9</span> Git 구축 및 설정</a></li>
<li><a class="" href="git-create.html"><span class="header-section-number">10</span> 저장소 생성</a></li>
<li><a class="" href="git-change.html"><span class="header-section-number">11</span> 변경사항 추적</a></li>
<li><a class="" href="git-history.html"><span class="header-section-number">12</span> 이력 탐색</a></li>
<li><a class="" href="git-ignore.html"><span class="header-section-number">13</span> 추적대상에서 제외</a></li>
<li><a class="" href="git-github.html"><span class="header-section-number">14</span> GitHub 원격작업</a></li>
<li><a class="" href="git-collab.html"><span class="header-section-number">15</span> 협업 (Collaborating)</a></li>
<li><a class="" href="git-conflict.html"><span class="header-section-number">16</span> 충돌 (Conflicts)</a></li>
<li><a class="" href="git-open.html"><span class="header-section-number">17</span> 공개 과학 (Open Science)</a></li>
<li><a class="" href="git-licensing.html"><span class="header-section-number">18</span> 라이선싱 (Licensing)</a></li>
<li><a class="" href="git-hosting.html"><span class="header-section-number">19</span> 호스팅 (Hosting)</a></li>
<li><a class="" href="git-korean.html"><span class="header-section-number">20</span> Git 추가설정</a></li>
<li class="book-part">프로그래밍</li>
<li><a class="" href="r-intro.html"><span class="header-section-number">21</span> R과 RStudio 소개</a></li>
<li><a class="" href="r-project.html"><span class="header-section-number">22</span> RStudio 프로젝트 관리</a></li>
<li><a class="" href="r-help.html"><span class="header-section-number">23</span> 도움 청하기</a></li>
<li><a class="" href="r-data-structure.html"><span class="header-section-number">24</span> 자료구조</a></li>
<li><a class="" href="r-dataframe.html"><span class="header-section-number">25</span> 데이터프레임 탐색</a></li>
<li><a class="" href="r-subset.html"><span class="header-section-number">26</span> 부분집합 추출</a></li>
<li><a class="" href="r-control-flow.html"><span class="header-section-number">27</span> 제어 흐름</a></li>
<li><a class="active" href="r-ggplot.html"><span class="header-section-number">28</span> 논문 품질 그래프 생성</a></li>
<li><a class="" href="r-vectorization.html"><span class="header-section-number">29</span> 벡터화(Vectorization)</a></li>
<li><a class="" href="r-function.html"><span class="header-section-number">30</span> 함수 설명</a></li>
<li><a class="" href="r-writing.html"><span class="header-section-number">31</span> 데이터 저장</a></li>
<li><a class="" href="r-plyr-split.html"><span class="header-section-number">32</span> plyr로 데이터프레임을 쪼개고 합치기</a></li>
<li><a class="" href="r-dplyr.html"><span class="header-section-number">33</span> dplyr 솜씨있게 조작</a></li>
<li><a class="" href="r-tidyr.html"><span class="header-section-number">34</span> tidyr 솜씨있게 조작</a></li>
<li><a class="" href="r-knitr.html"><span class="header-section-number">35</span> knitr 보고서 생성</a></li>
<li><a class="" href="r-wrapup.html"><span class="header-section-number">36</span> 좋은 소프트웨어 작성법</a></li>
<li class="book-part">데이터베이스</li>
<li><a class="" href="database-sql.html"><span class="header-section-number">37</span> 데이터베이스와 SQL 사용하기</a></li>
<li><a class="" href="database-sqlite.html"><span class="header-section-number">38</span> SQLite 설치</a></li>
<li><a class="" href="database-select.html"><span class="header-section-number">39</span> 변수/칼럼 선택하기</a></li>
<li><a class="" href="database-sort.html"><span class="header-section-number">40</span> 정렬, 중복 제거</a></li>
<li><a class="" href="database-filter.html"><span class="header-section-number">41</span> 필터링 (Filtering)</a></li>
<li><a class="" href="database-calc.html"><span class="header-section-number">42</span> 새로운 값 계산하기</a></li>
<li><a class="" href="database-null.html"><span class="header-section-number">43</span> 결측 데이터 (Missing Data)</a></li>
<li><a class="" href="database-agg.html"><span class="header-section-number">44</span> 집합(Aggregation)</a></li>
<li><a class="" href="database-table-join.html"><span class="header-section-number">45</span> 데이터 결합하기</a></li>
<li><a class="" href="database-data-create.html"><span class="header-section-number">46</span> 데이터 생성과 변형</a></li>
<li class="book-part">작업흐름 관리도구</li>
<li><a class="" href="make-automation-intro.html"><span class="header-section-number">47</span> 자동화와 Make</a></li>
<li><a class="" href="make-automation.html"><span class="header-section-number">48</span> 들어가며</a></li>
<li><a class="" href="make-makefiles-chapter.html"><span class="header-section-number">49</span> Makefiles</a></li>
<li><a class="" href="make-makefiles.html"><span class="header-section-number">50</span> 자동 변수</a></li>
<li><a class="" href="make-dependencies.html"><span class="header-section-number">51</span> 데이터와 코드 의존성</a></li>
<li><a class="" href="make-patterns.html"><span class="header-section-number">52</span> 패턴 규칙</a></li>
<li><a class="" href="make-variable.html"><span class="header-section-number">53</span> 변수</a></li>
<li><a class="" href="make-function.html"><span class="header-section-number">54</span> 함수</a></li>
<li><a class="" href="make-self-doc.html"><span class="header-section-number">55</span> 문서화 Makefile</a></li>
<li><a class="" href="make-conclusion.html"><span class="header-section-number">56</span> 결론</a></li>
<li><a class="" href="%EC%B0%B8%EA%B3%A0%EB%AC%B8%ED%97%8C.html">참고문헌</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="r-ggplot" class="section level1" number="28">
<h1>
<span class="header-section-number">28 . </span> 논문 품질 그래프 생성<a class="anchor" aria-label="anchor" href="#r-ggplot"><i class="fas fa-link"></i></a>
</h1>
<p>데이터를 도식화하는 것이 변수간 다양한 관계를 재빨리 탐색하는 최상의 방식 중 하나다.</p>
<p>R에는 세가지 주류 도식화 시스템이 존재한다: <a href="http://www.statmethods.net/graphs/">Base 도식화 시스템</a>, <a href="http://www.statmethods.net/advgraphs/trellis.html">lattice</a>
팩키지, <a href="http://www.statmethods.net/advgraphs/ggplot2.html">ggplot2</a> 팩키지.</p>
<p>금일, <code>ggplot2</code> 팩키지를 학습할 것인데 이유는 논문 품질 그래프를 생성하는데
가장 효과적이기 때문이다.</p>
<p><code>ggplot2</code>는 그래픽 문법(grammar of graphics)에 기반했다.
즉, 어떤 그래프도 동일한 구성요소 집합으로 표현된다:
<strong>데이터</strong>셋, <strong>좌표 시스템</strong>, <strong>geoms</strong> 집합 – 데이터 점에 대한 시각적 표현.</p>
<p><code>ggplot2</code>를 이해하는 핵심은 그림을 계층으로 사고하는 것이다:
포토샵(Photoshop), 일러스트레이터(Illustrator), 잉크스케이프(Inkscape.) 같은 이미지 편집 프로그램으로 작업하는 것과 같다.</p>
<p>예제를 가지고 시작해본다:</p>
<div class="sourceCode" id="cb864"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/lifeExp-vs-gdpPercap-scatter-1.png" width="576" style="display: block; margin: auto;"></div>
<p>그래서, 처음으로 수행하는 작업은 <code>ggplot</code> 함수를 호출하는 것이다.
이 함수가 R에게 새로운 그림을 생성하고,
<code>ggplot</code> 함수에 전달하는 어떤 인자도 해당 그림에 <em>전역</em> 선택옵션(그림에 있는 모든 계층에 적용)임을 전달한다.</p>
<p><code>ggplot</code>에 인자를 두개 전달했다.
먼저, <code>ggplot</code>에 그림에 사용할 데이터가 무엇인지 전달한다;
번 예제에서 앞에서 불러온 <code>gapminder</code>데이터.
두번째 인자를 <code>aes</code>함수에 전달했는데,
<code>ggplot</code>에게 <strong>데이터</strong>에 나온 변수를 도식화하는 그림의 <em>미학적인</em> 속성에 매핑하는 방법을 전달한다;
이번 경우에는 <strong>x</strong>와 <strong>y</strong> 위치. 여기서 <code>ggplot</code>에 <code>gapminder</code>데이터프레임 “lifeExp” 칼럼을 <strong>x</strong>-축에,
“gdpPercap” 칼럼을 <strong>y</strong>-축에 도식화한다.
명시적으로 <code>aes</code>에 칼럼명을 전달(예를 들어, x = gapminder[, “lifeExp”]<code>)하지 않은 것에 주목한다.  이것이 가능한 이유는</code>ggplot` 함수가 <strong>데이터</strong>에 존재하는 칼럼을 식별할만큼 똑똑하기 때문이다!</p>
<p>그 자체로, <code>ggplot</code>함수를 호출한다고 도식화가 바로 되는 것은 아니다:</p>
<div class="sourceCode" id="cb865"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/r-ggplot-1.png" width="576" style="display: block; margin: auto;"></div>
<p><code>ggplot</code> 함수에 데이터를 시각적으로 표현하는 방법을 전달할 필요가 있다.
<strong>geom</strong> 계층을 추가해서 작업이 수행된다. 본 사례에서, <code>geom_point</code>를 사용했다;
<strong>x</strong>와 <strong>y</strong> 사이 관계를 시각적으로 산점도 형태로 표현하도록 <code>ggplot</code>에게 전달한다:</p>
<div class="sourceCode" id="cb866"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/lifeExp-vs-gdpPercap-scatter2-1.png" width="576" style="display: block; margin: auto;"></div>
<div id="r-ggplot-challenge-one" class="section level2" number="28.1">
<h2>
<span class="header-section-number">28.1</span> 도전과제 1<a class="anchor" aria-label="anchor" href="#r-ggplot-challenge-one"><i class="fas fa-link"></i></a>
</h2>
<p>상기예제를 변경해서, 기대수명이 시간에 따라 어떻게
변해왔는지 시각화하는 그림을 생성한다:</p>
<div class="sourceCode" id="cb867"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><strong>힌트:</strong> <code>gapminder</code> 데이터셋에 “year”라는 칼럼이 있는데, <strong>x</strong>-축에 나타나야 된다.</p>
<blockquote>
<p><strong>도전과제 1에 대한 해답</strong></p>
<p>한가지 해법은 다음과 같다:</p>
<div class="sourceCode" id="cb868"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/ch1-sol-1.png" width="576" style="display: block; margin: auto;"></div>
</blockquote>
</div>
<div id="r-ggplot-challenge-two" class="section level2" number="28.2">
<h2>
<span class="header-section-number">28.2</span> 도전과제 2<a class="anchor" aria-label="anchor" href="#r-ggplot-challenge-two"><i class="fas fa-link"></i></a>
</h2>
<p>이전 예제와 도전과제에서, <code>aes</code> 함수를 사용해서 <strong>geom</strong> 산점도로 <strong>x</strong> 와 <strong>y</strong> 지점을
각 점에 대해 표현했다.
변경할 수 있는 또다른 <em>미학적</em> 속성은 각 점에 대한 <em>색깔</em>이다.
앞선 도전과제 코드를 변경해서 “continent” 대륙별로 각 점에 <strong>색</strong>을 입힌다.
데이터에서 어떤 경향성을 볼 수 있는가? 예상했던 경향성인가?</p>
<blockquote>
<p><strong>도전과제 2에 대한 해답</strong></p>
<p>앞선 예제와 도전과제에서 <strong>x</strong> 와 <strong>y</strong>의 각 점에 대한 좌표로 <strong>geom</strong> 산점도를
<code>aes</code>함수에 사용했다.
<em>aesthetic</em>의 또다른 특성으로 점에 대한 <em>색상</em>을 변경할 수 있다는 점이다.
“continent” 칼럼을 <strong>색상(color)</strong>에 적용해서 이전 도전과제 코드에 접목시켜보자.
데이터에서 어떤 추세를 볼 수 있는가? 추세가 예상했던 것인가?</p>
<div class="sourceCode" id="cb869"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/ch2-sol-1.png" width="576" style="display: block; margin: auto;"></div>
</blockquote>
</div>
<div id="r-ggplot-layer" class="section level2" number="28.3">
<h2>
<span class="header-section-number">28.3</span> 계층(Layers)<a class="anchor" aria-label="anchor" href="#r-ggplot-layer"><i class="fas fa-link"></i></a>
</h2>
<p>산점도가 아마도 시간에 따라 변하는 정보를 시각화하는데 최선은 아니다.
대신에, <code>ggplot</code>에 선그래프(line plot)로 데이터를 시각화한다:</p>
<div class="sourceCode" id="cb870"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, by<span class="op">=</span><span class="va">country</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/lifeExp-line-1.png" width="576" style="display: block; margin: auto;"></div>
<p><code>geom_point</code> 계층을 추가하는 대신에, <code>geom_line</code> 계층을 추가했다.
<em>aes</em>로 <strong>by</strong>를 추가해서, <code>ggplot</code>이 각 국가를 직선으로 연결해서 도식화한다.</p>
<p>하지만, 직선과 점을 함께 시각화하려고 하면 어떨까?
단순히, 또다른 계층을 그림에 추가하면 된다:</p>
<div class="sourceCode" id="cb871"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, by<span class="op">=</span><span class="va">country</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/lifeExp-line-point-1.png" width="576" style="display: block; margin: auto;"></div>
<p>각 계층은 이전 계층 위에 도식화됨에 주목한다.
이번 예제에서, 점이 직선 <em>위에</em> 도식화되었다.
다음에 도식화한 산출물이 나와있다:</p>
<div class="sourceCode" id="cb872"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, by<span class="op">=</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/lifeExp-layer-example-1-1.png" width="576" style="display: block; margin: auto;"></div>
<p>이번 예제에서, <em>aesthetic</em>인 <strong>색상</strong> 매핑이 <code>ggplot</code>에 전역으로 설정된 점 선택옵션에서
<code>geom_line</code> 계층으로 이동했다. 그래서, 해당 점에는 더이상 적용되지 않는다.
이제 분명하게 직선 위에 점이 도식화된 것을 확인할 수 있다.</p>
<div id="r-ggplot-aes" class="rmdcaution">
<p><strong>꿀팁: <code>aesthetic</code>에 매핑대신에 값을 설정</strong></p>
<p>지금까지 (<strong>색상</strong>같은) aesthetic 를 데이터의 변수로 <em>매핑(mapping)</em>해서 사용하는 법을 살펴봤다.
예를 들어, <code>geom_line(aes(color=continent))</code>을 사용하면, ggplot에서 자동으로 각 대륙별로 다른 색상을 입힌다.
그런데, 모든 선을 파란색으로 바꾸고자 하면 어떨까? <code>geom_line(aes(color="blue"))</code> 명령어가 동작해야 된다고 생각하지만,
사실은 그렇지 않다.특정 변수에 대한 매핑을 생성하지 않았기 대문에,
<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> 함수 밖으로 색상을 명세하는 부분을 예를 들어, <code>geom_line(color="blue")</code>와 같이 빼내기만 하면 된다.</p>
</div>
</div>
<div id="r-ggplot-challenge-three" class="section level2" number="28.4">
<h2>
<span class="header-section-number">28.4</span> 도전과제 3<a class="anchor" aria-label="anchor" href="#r-ggplot-challenge-three"><i class="fas fa-link"></i></a>
</h2>
<p>앞선 예제에서 점과 직선 계층 코딩 순서를 뒤바꾼다. 어떻게 될까요?</p>
<blockquote>
<p><strong>도전과제 3에 대한 해답</strong></p>
<p>앞선 예제에서 점과 직선 계층 코딩 순서를 뒤바꾼다. 어떻게 될까요?</p>
<div class="sourceCode" id="cb873"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, by<span class="op">=</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/ch3-sol-1.png" width="576" style="display: block; margin: auto;"></div>
<p>선이 점 위에 올라온다!</p>
</blockquote>
</div>
<div id="r-ggplot-transformation" class="section level2" number="28.5">
<h2>
<span class="header-section-number">28.5</span> 변환과 통계량<a class="anchor" aria-label="anchor" href="#r-ggplot-transformation"><i class="fas fa-link"></i></a>
</h2>
<p>변환(Transformations)과 통계량(statistics)을 살펴보자.
<code>ggplot</code>으로 데이터 위에 통계적 모형을 쉽게 겹치게 할 수 있다.
이를 시연하기 위해서, 첫번째 예제로 되돌아간다:</p>
<div class="sourceCode" id="cb874"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/lifeExp-vs-gdpPercap-scatter3-1.png" width="576" style="display: block; margin: auto;"></div>
<p>현재, 일인당 GDP에 일부 심각한 이상점이 있어 점사이 내재된 관계를 보기 힘들다.
<em>scale</em> 척도함수를 사용해서 y-축 척도를 변경한다.
이것을 통해 데이터 값과 <em>aesthetic</em> 시각값 사이 매핑을 제어한다.
<em>alpha</em> 함수를 통해 투명도도 조정할 수 있다.
군집으로 많은 데이터가 모아진 경우 특히 투명도 조절을 유용하다.</p>
<div class="sourceCode" id="cb875"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/axis-scale-1.png" width="576" style="display: block; margin: auto;"></div>
<p>그림에 렌더링하기 전에 <code>log10</code> 함수가 <code>gdpPercap</code> 칼럼값에 변환을 시켰다.
그래서, 각 자리수 10은 변환된 척도에 1씩 증가에 대응된다.
예를 들어, 1인당 GDP 1,000은 y-축에 3, 10,000은 y-축에 4에 대응된다.
로그 변환은 x-축에 흩어진 데이터 시각화를 쉽게 도와준다.</p>
<div id="r-ggplot-mapping" class="rmdcaution">
<p><strong>꿀팁: <code>aesthetic</code>에 매핑대신에 값을 설정</strong></p>
<p><code>geom_point(alpha = 0.5)</code> 을 사용한 것에 주목한다.
앞서 언급했듯이, <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> 함수 외부에서 설정된 것은 모든 점에 대해서 지정한 값이 적용되게 된다.
투명도 지정은 이 경우 원하는 바로 문제가 전혀 없다.
하지만, 다른 <code>aesthetic</code> 설정처럼, <em>alpha</em> 투명도를 데이터의 변수에 매핑시킬 수도 있다.
예를 들어, 각 대륙별로 다른 투명도를 적용시키고자 하면, <code>geom_point(aes(alpha = continent))</code> 코딩하는 것도 가능하다.</p>
</div>
<p>또다른 계층(<code>geom_smooth</code>)을 추가해서 관계를 단순히 적합시킬 수 있다:</p>
<div class="sourceCode" id="cb876"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/lm-fit-1.png" width="576" style="display: block; margin: auto;"></div>
<p>굵은 선은 <code>geom_smooth</code> 계층에 <em>aesthetic</em> <strong>크기</strong>를 설정해서 조정할 수 있다:</p>
<div class="sourceCode" id="cb877"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/lm-fit2-1.png" width="576" style="display: block; margin: auto;"></div>
<p><em>미학적인</em> 항목을 명세할 수 있는 방식이 두개 있다.
바로 앞에서 <code>geom_smooth</code> 함수에 인자로 전달해서 <strong>크기</strong>에 대한 미학적인 설정을 했다.
앞에서는 <code>aes</code> 함수를 사용해서 데이터 변수와 시각적 표현 사이 <em>매핑</em>으로 정의했다.</p>
</div>
<div id="r-ggplot-challenge-four-a" class="section level2" number="28.6">
<h2>
<span class="header-section-number">28.6</span> 도전과제 4a<a class="anchor" aria-label="anchor" href="#r-ggplot-challenge-four-a"><i class="fas fa-link"></i></a>
</h2>
<p>바로 앞 예제에서 점 계층에 나온 점 크기와 색상을 변경하라.
<strong>힌트:</strong> <code>aes</code> 함수를 사용하지 않는다.</p>
<blockquote>
<p><strong>도전과제 4a에 대한 해답</strong></p>
<p>바로 앞 예제에서 점 계층에 나온 점 크기와 색상을 변경하라.</p>
<p><strong>힌트:</strong> <code>aes</code> 함수를 사용하지 않는다.</p>
<div class="sourceCode" id="cb878"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span>, color<span class="op">=</span><span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/ch4a-sol-1.png" width="576" style="display: block; margin: auto;"></div>
</blockquote>
</div>
<div id="r-ggplot-challenge-four-b" class="section level2" number="28.7">
<h2>
<span class="header-section-number">28.7</span> 도전과제 4b<a class="anchor" aria-label="anchor" href="#r-ggplot-challenge-four-b"><i class="fas fa-link"></i></a>
</h2>
<p>도전과제 4a를 변경하는데,
점들이 다른 형태(shape)를 갖고 대륙별로 색상을 달리하는데
대륙별로 추세선을 반영한다.</p>
<p>힌트: 색상 인자를 <code>aesthetic</code> 내부로 위치시킨다.</p>
<blockquote>
<p><strong>도전과제 4b에 대한 해답</strong></p>
<p>도전과제 4a를 변경하는데,
점들이 다른 형태(shape)를 갖고 대륙별로 색상을 달리하는데
대륙별로 추세선을 반영한다.
힌트: 색상 인자를 <code>aesthetic</code> 내부로 위치시킨다.</p>
<div class="sourceCode" id="cb879"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, color <span class="op">=</span> <span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span>, shape<span class="op">=</span><span class="fl">17</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/ch4b-sol-1.png" width="576" style="display: block; margin: auto;"></div>
</blockquote>
</div>
<div id="r-ggplot-multi-panel" class="section level2" number="28.8">
<h2>
<span class="header-section-number">28.8</span> 다중-창(Multi-Panel) 그림<a class="anchor" aria-label="anchor" href="#r-ggplot-multi-panel"><i class="fas fa-link"></i></a>
</h2>
<p>앞에서 그림 하나에 모든 국가에 대해 시간의 변화에 따른 기대수명 변화를 시각화했다.
대안으로, <strong>패싯(facet)</strong> 창 계층을 추가해서, 그림을 여러개 창으로 쪼갤 수도 있다:
“A” 혹은 “Z”로 시작하는 국가명을 갖는 나라만 집중해 보자.</p>
<div id="r-tips-multi-panel" class="rmdcaution">
<p><strong>팁(Tip)</strong></p>
<p>데이터 부분집합(subset)을 추출하고 시작해 나간다.
<code>substr</code> 함수를 사용해서 문자열의 일부를 뽑아낸다; 이 경우에,
<code>gapminder$country</code> 벡터의 시작과 끝 위치 문자가 된다.
<code>%in%</code> 연산자를 통해서 조건을 만족하는 긴 코드 대신에 다중 비교를
간단히 수행한다.
(이 경우, <code>starts.with %in% c("A", "Z")</code> 코드는
<code>starts.with == "A" | starts.with == "Z"</code>)와 동일하다)</p>
</div>
<div class="sourceCode" id="cb880"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starts.with</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">country</span>, start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">az.countries</span> <span class="op">&lt;-</span> <span class="va">gapminder</span><span class="op">[</span><span class="va">starts.with</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"Z"</span><span class="op">)</span>, <span class="op">]</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">az.countries</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">country</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/facet-1.png" width="576" style="display: block; margin: auto;"></div>
<p><code>facet_wrap</code> 계층은 “공식(formula)”을 인자로 받는데, (<code>~</code>) 틸드로 표기한다.
<code>gapminder</code> 데이터셋 국가별 칼럼의 유일한 값 각각에 대해 별도 창을 통해 도식화한다.</p>
</div>
<div id="r-ggplot-text" class="section level2" number="28.9">
<h2>
<span class="header-section-number">28.9</span> 텍스트 변경<a class="anchor" aria-label="anchor" href="#r-ggplot-text"><i class="fas fa-link"></i></a>
</h2>
<p>논문 출판으로 그림을 깔끔하게 만들려면, 텍스트 요소를 일부 변경할 필요가 있다.
x-축이 너무 난잡하고, y-축은 데이터프레임 칼럼명이 아닌 “Life expectancy”으로 적혀야 된다.</p>
<p>몇개 다른 계층을 추가함으로써 텍스트를 변경할 수 있다.
<strong>theme</strong> 계층은 각 축에 대한 텍스트, 전반적인 텍스트 크기를 제어한다.
축, 그래프 제목, 범례는 <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> 함수를 사용해서 설정하다.
범례 제목은 <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> 함수에서 명세한 것과 동일한 명칭을 사용한다.
따라서, 색상 범례 제목은 <code>color = "Continent"</code>이 되는 반면에,
채우기(<code>fill</code>) 범례는 <code>fill = "MyTitle"</code>으로 설정하게 된다.</p>
<div class="sourceCode" id="cb881"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">az.countries</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Year"</span>,              <span class="co"># x axis title</span>
    y <span class="op">=</span> <span class="st">"Life expectancy"</span>,   <span class="co"># y axis title</span>
    title <span class="op">=</span> <span class="st">"Figure 1"</span>,      <span class="co"># main title of figure</span>
    color <span class="op">=</span> <span class="st">"Continent"</span>      <span class="co"># title of legend</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/theme-1.png" width="576" style="display: block; margin: auto;"></div>
</div>
<div id="r-ggplot-export" class="section level2" number="28.10">
<h2>
<span class="header-section-number">28.10</span> 그래프 내보내기<a class="anchor" aria-label="anchor" href="#r-ggplot-export"><i class="fas fa-link"></i></a>
</h2>
<p><code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> 함수를 사용해서 <code>ggplot</code>으로 생성시킨 그래프를 내보내서 로컬 컴퓨터에 저장할 수 있다.
출판을 위한 고품질 그래픽 산출물을 생성하기 위해서
그래프 크기와 해상도를 <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> 함수의 인자(<code>width</code>, <code>height</code>, <code>dpi</code>)로 넘기면 된다.
앞서 생성한 그래프를 저장하려면,
먼저 <code>lifeExp_plot</code> 변수에 그래프를 할당하고 나서,
<code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> 함수에 <code>png</code> 형식으로 <code>results</code> 디렉토리에 저장하도록 지정한다.
(현 작업디렉토리에 <code>results/</code> 폴더가 생성되어 있어야 한다.)</p>
<div class="sourceCode" id="cb882"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lifeExp_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">az.countries</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Year"</span>,              <span class="co"># x axis title</span>
    y <span class="op">=</span> <span class="st">"Life expectancy"</span>,   <span class="co"># y axis title</span>
    title <span class="op">=</span> <span class="st">"Figure 1"</span>,      <span class="co"># main title of figure</span>
    color <span class="op">=</span> <span class="st">"Continent"</span>      <span class="co"># title of legend</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"results/lifeExp.png"</span>, plot <span class="op">=</span> <span class="va">lifeExp_plot</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">10</span>, dpi <span class="op">=</span> <span class="fl">300</span>, units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></code></pre></div>
<p><code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> 함수에 두가지 멋진 점이 있다.
첫째는 기본설정값으로 가장 마지막 그래프가 지정되어 있어서,
<code>plot</code> 인자를 생략하게 되면, 자동으로 <code>ggplot</code>으로 생성한 마지막 그래프가 저장된다.
둘째로, 저장되는 그래프 이미지 형식이 파일명으로 전달하는 파일 확장자(예를 들어, <code>.png</code> 혹은 <code>.pdf</code>)에 따라 결정된다.
필요한 경우, <code>device</code> 인자에 명시적으로 파일 형식을 지정할 수도 있다.</p>
<p>지금까지 <code>ggplot2</code> 맛을 보았다. RStudio는 정말 유용한 <a href="http://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">cheat sheet</a>를 통해서 다른 계층 사용법에 대한
참고서로 충실한 정보를 제공하고 있고, <a href="http://docs.ggplot2.org/current/">ggplot2 웹사이트</a>에 추가기능에 대한 상세한 정보가 공개되어 있다.</p>
<p>마지막으로, 어떻게 수정을 해야하는지 아무런 생각이 없다면, 구글 검색을 통해서 결국 Stack Overflow 웹사이트에
재사용 가능한 코드를 통해서 관련된 질문과 답변을 수월히 얻을 수 있다!</p>
</div>
<div id="r-ggplot-challenge-five" class="section level2" number="28.11">
<h2>
<span class="header-section-number">28.11</span> 도전과제 5<a class="anchor" aria-label="anchor" href="#r-ggplot-challenge-five"><i class="fas fa-link"></i></a>
</h2>
<p>대륙별로 채워진 1인당 GPD 밀도 그래프를 생성하라.
고급:
- x-축을 변경해서 쭉 펼쳐진 데이터를 좀더 보기좋게 시각화하라.
- 패싯 계층을 추가해서 연도별로 밀도 그래프를 창에 도식화하라.</p>
<blockquote>
<p><strong>도전과제 5에 대한 해답</strong></p>
<p>대륙별로 채워진 1인당 GPD 밀도 그래프를 생성하라.</p>
<p>고급:
- x-축을 변경해서 쭉 펼쳐진 데이터를 좀더 보기좋게 시각화하라.
- 패싯 계층을 추가해서 연도별로 밀도 그래프를 창에 도식화하라.</p>
<div class="sourceCode" id="cb883"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, fill<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">year</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-plot-ggplot2_files/figure-html/ch5-sol-1.png" width="576" style="display: block; margin: auto;"></div>
</blockquote>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="r-control-flow.html"><span class="header-section-number">27</span> 제어 흐름</a></div>
<div class="next"><a href="r-vectorization.html"><span class="header-section-number">29</span> 벡터화(Vectorization)</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#r-ggplot"><span class="header-section-number">28</span> 논문 품질 그래프 생성</a></li>
<li><a class="nav-link" href="#r-ggplot-challenge-one"><span class="header-section-number">28.1</span> 도전과제 1</a></li>
<li><a class="nav-link" href="#r-ggplot-challenge-two"><span class="header-section-number">28.2</span> 도전과제 2</a></li>
<li><a class="nav-link" href="#r-ggplot-layer"><span class="header-section-number">28.3</span> 계층(Layers)</a></li>
<li><a class="nav-link" href="#r-ggplot-challenge-three"><span class="header-section-number">28.4</span> 도전과제 3</a></li>
<li><a class="nav-link" href="#r-ggplot-transformation"><span class="header-section-number">28.5</span> 변환과 통계량</a></li>
<li><a class="nav-link" href="#r-ggplot-challenge-four-a"><span class="header-section-number">28.6</span> 도전과제 4a</a></li>
<li><a class="nav-link" href="#r-ggplot-challenge-four-b"><span class="header-section-number">28.7</span> 도전과제 4b</a></li>
<li><a class="nav-link" href="#r-ggplot-multi-panel"><span class="header-section-number">28.8</span> 다중-창(Multi-Panel) 그림</a></li>
<li><a class="nav-link" href="#r-ggplot-text"><span class="header-section-number">28.9</span> 텍스트 변경</a></li>
<li><a class="nav-link" href="#r-ggplot-export"><span class="header-section-number">28.10</span> 그래프 내보내기</a></li>
<li><a class="nav-link" href="#r-ggplot-challenge-five"><span class="header-section-number">28.11</span> 도전과제 5</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>데이터 과학을 지탱하는 기본기</strong>" was written by 한국 알 사용자회. It was last built on 2022-05-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
