<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>30 . 함수 설명 | 데이터 과학을 지탱하는 기본기</title>
<meta name="author" content="한국 알 사용자회">
<meta name="description" content="분석할 데이터셋이 하나라면, 파일을 엑셀같은 스프레드쉬트로 불러와서 간단한 통계량을 도식화하는 것이 아마도 훨씬 빠를 것이다. 하지만, gapminder 데이터는 주기적으로 갱신되서, 나중에 새로운 정보를 뽑아와서 분석작업을 다시 실행할 수도 있다. 또한, 미래 특정 시점에 다양한 곳에서 유사한 데이터를 얻어올 수도 있다. 이번 수업에서, 단일...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="30 . 함수 설명 | 데이터 과학을 지탱하는 기본기">
<meta property="og:type" content="book">
<meta property="og:description" content="분석할 데이터셋이 하나라면, 파일을 엑셀같은 스프레드쉬트로 불러와서 간단한 통계량을 도식화하는 것이 아마도 훨씬 빠를 것이다. 하지만, gapminder 데이터는 주기적으로 갱신되서, 나중에 새로운 정보를 뽑아와서 분석작업을 다시 실행할 수도 있다. 또한, 미래 특정 시점에 다양한 곳에서 유사한 데이터를 얻어올 수도 있다. 이번 수업에서, 단일...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="30 . 함수 설명 | 데이터 과학을 지탱하는 기본기">
<meta name="twitter:description" content="분석할 데이터셋이 하나라면, 파일을 엑셀같은 스프레드쉬트로 불러와서 간단한 통계량을 도식화하는 것이 아마도 훨씬 빠를 것이다. 하지만, gapminder 데이터는 주기적으로 갱신되서, 나중에 새로운 정보를 뽑아와서 분석작업을 다시 실행할 수도 있다. 또한, 미래 특정 시점에 다양한 곳에서 유사한 데이터를 얻어올 수도 있다. 이번 수업에서, 단일...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-229551680-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-229551680-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">데이터 과학을 지탱하는 기본기</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">데이터 과학을 지탱하는 기본기</a></li>
<li class="book-part">자동화</li>
<li><a class="" href="shell-intro.html"><span class="header-section-number">1</span> 쉘(Shell) 소개</a></li>
<li><a class="" href="shell-filedir.html"><span class="header-section-number">2</span> 파일과 폴더 넘나들기</a></li>
<li><a class="" href="shell-create.html"><span class="header-section-number">3</span> 파일과 디렉토리 작업</a></li>
<li><a class="" href="pipe-filter.html"><span class="header-section-number">4</span> 파이프와 필터</a></li>
<li><a class="" href="shell-loop.html"><span class="header-section-number">5</span> 루프(Loops)</a></li>
<li><a class="" href="shell-script.html"><span class="header-section-number">6</span> 쉘 스크립트</a></li>
<li><a class="" href="shell-find.html"><span class="header-section-number">7</span> 파일, 문자, 디렉토리 등 찾기</a></li>
<li class="book-part">버전제어와 협업</li>
<li><a class="" href="git.html"><span class="header-section-number">8</span> 자동화된 버젼제어</a></li>
<li><a class="" href="git-setup.html"><span class="header-section-number">9</span> Git 구축 및 설정</a></li>
<li><a class="" href="git-create.html"><span class="header-section-number">10</span> 저장소 생성</a></li>
<li><a class="" href="git-change.html"><span class="header-section-number">11</span> 변경사항 추적</a></li>
<li><a class="" href="git-history.html"><span class="header-section-number">12</span> 이력 탐색</a></li>
<li><a class="" href="git-ignore.html"><span class="header-section-number">13</span> 추적대상에서 제외</a></li>
<li><a class="" href="git-github.html"><span class="header-section-number">14</span> GitHub 원격작업</a></li>
<li><a class="" href="git-collab.html"><span class="header-section-number">15</span> 협업 (Collaborating)</a></li>
<li><a class="" href="git-conflict.html"><span class="header-section-number">16</span> 충돌 (Conflicts)</a></li>
<li><a class="" href="git-open.html"><span class="header-section-number">17</span> 공개 과학 (Open Science)</a></li>
<li><a class="" href="git-licensing.html"><span class="header-section-number">18</span> 라이선싱 (Licensing)</a></li>
<li><a class="" href="git-hosting.html"><span class="header-section-number">19</span> 호스팅 (Hosting)</a></li>
<li><a class="" href="git-korean.html"><span class="header-section-number">20</span> Git 추가설정</a></li>
<li class="book-part">프로그래밍</li>
<li><a class="" href="r-intro.html"><span class="header-section-number">21</span> R과 RStudio 소개</a></li>
<li><a class="" href="r-project.html"><span class="header-section-number">22</span> RStudio 프로젝트 관리</a></li>
<li><a class="" href="r-help.html"><span class="header-section-number">23</span> 도움 청하기</a></li>
<li><a class="" href="r-data-structure.html"><span class="header-section-number">24</span> 자료구조</a></li>
<li><a class="" href="r-dataframe.html"><span class="header-section-number">25</span> 데이터프레임 탐색</a></li>
<li><a class="" href="r-subset.html"><span class="header-section-number">26</span> 부분집합 추출</a></li>
<li><a class="" href="r-control-flow.html"><span class="header-section-number">27</span> 제어 흐름</a></li>
<li><a class="" href="r-ggplot.html"><span class="header-section-number">28</span> 논문 품질 그래프 생성</a></li>
<li><a class="" href="r-vectorization.html"><span class="header-section-number">29</span> 벡터화(Vectorization)</a></li>
<li><a class="active" href="r-function.html"><span class="header-section-number">30</span> 함수 설명</a></li>
<li><a class="" href="r-writing.html"><span class="header-section-number">31</span> 데이터 저장</a></li>
<li><a class="" href="r-plyr-split.html"><span class="header-section-number">32</span> plyr로 데이터프레임을 쪼개고 합치기</a></li>
<li><a class="" href="r-dplyr.html"><span class="header-section-number">33</span> dplyr 솜씨있게 조작</a></li>
<li><a class="" href="r-tidyr.html"><span class="header-section-number">34</span> tidyr 솜씨있게 조작</a></li>
<li><a class="" href="r-knitr.html"><span class="header-section-number">35</span> knitr 보고서 생성</a></li>
<li><a class="" href="r-wrapup.html"><span class="header-section-number">36</span> 좋은 소프트웨어 작성법</a></li>
<li class="book-part">데이터베이스</li>
<li><a class="" href="database-sql.html"><span class="header-section-number">37</span> 데이터베이스와 SQL 사용하기</a></li>
<li><a class="" href="database-sqlite.html"><span class="header-section-number">38</span> SQLite 설치</a></li>
<li><a class="" href="database-select.html"><span class="header-section-number">39</span> 변수/칼럼 선택하기</a></li>
<li><a class="" href="database-sort.html"><span class="header-section-number">40</span> 정렬, 중복 제거</a></li>
<li><a class="" href="database-filter.html"><span class="header-section-number">41</span> 필터링 (Filtering)</a></li>
<li><a class="" href="database-calc.html"><span class="header-section-number">42</span> 새로운 값 계산하기</a></li>
<li><a class="" href="database-null.html"><span class="header-section-number">43</span> 결측 데이터 (Missing Data)</a></li>
<li><a class="" href="database-agg.html"><span class="header-section-number">44</span> 집합(Aggregation)</a></li>
<li><a class="" href="database-table-join.html"><span class="header-section-number">45</span> 데이터 결합하기</a></li>
<li><a class="" href="database-data-create.html"><span class="header-section-number">46</span> 데이터 생성과 변형</a></li>
<li class="book-part">작업흐름 관리도구</li>
<li><a class="" href="make-automation-intro.html"><span class="header-section-number">47</span> 자동화와 Make</a></li>
<li><a class="" href="make-automation.html"><span class="header-section-number">48</span> 들어가며</a></li>
<li><a class="" href="make-makefiles-chapter.html"><span class="header-section-number">49</span> Makefiles</a></li>
<li><a class="" href="make-makefiles.html"><span class="header-section-number">50</span> 자동 변수</a></li>
<li><a class="" href="make-dependencies.html"><span class="header-section-number">51</span> 데이터와 코드 의존성</a></li>
<li><a class="" href="make-patterns.html"><span class="header-section-number">52</span> 패턴 규칙</a></li>
<li><a class="" href="make-variable.html"><span class="header-section-number">53</span> 변수</a></li>
<li><a class="" href="make-function.html"><span class="header-section-number">54</span> 함수</a></li>
<li><a class="" href="make-self-doc.html"><span class="header-section-number">55</span> 문서화 Makefile</a></li>
<li><a class="" href="make-conclusion.html"><span class="header-section-number">56</span> 결론</a></li>
<li><a class="" href="%EC%B0%B8%EA%B3%A0%EB%AC%B8%ED%97%8C.html">참고문헌</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="r-function" class="section level1" number="30">
<h1>
<span class="header-section-number">30 . </span> 함수 설명<a class="anchor" aria-label="anchor" href="#r-function"><i class="fas fa-link"></i></a>
</h1>
<p>분석할 데이터셋이 하나라면, 파일을 엑셀같은 스프레드쉬트로 불러와서
간단한 통계량을 도식화하는 것이 아마도 훨씬 빠를 것이다.
하지만, <code>gapminder</code> 데이터는 주기적으로 갱신되서,
나중에 새로운 정보를 뽑아와서 분석작업을 다시 실행할 수도 있다.
또한, 미래 특정 시점에 다양한 곳에서 유사한 데이터를 얻어올 수도 있다.</p>
<p>이번 수업에서, 단일 명령어로 여러가지 연산작업을 반복하는
함수 작성방법을 학습할 것이다.</p>
<div id="function-definition" class="rmdcaution">
<p><strong>함수란 무엇인가?</strong></p>
<p>함수는 연속된 연산작업을 모아 전체를 하나로 만들고,
향후 사용을 위해 보관된다. 함수는 다음 기능을 제공한다:</p>
<ul>
<li>기억할 수 있고 나중에 호출할 수 있는 명칭</li>
<li>개별적인 연산을 기억할 필요에서 해방</li>
<li>사전에 정의된 입력과 예상되는 출력</li>
<li>더 큰 프로그래밍 환경에 풍부한 연계성</li>
</ul>
<p>프로그래밍 언어 대부분의 기본 구성요소로서,
사용자 정의 함수는 어떠한 단일 추상화 못지 않는 중요한 “프로그래밍”으로 간주된다.
함수를 작성할 수 있다면, 여러분은 컴퓨터 프로그래머다:</p>
</div>
<div id="r-funciton-definition" class="section level2" number="30.1">
<h2>
<span class="header-section-number">30.1</span> 함수 정의하기<a class="anchor" aria-label="anchor" href="#r-funciton-definition"><i class="fas fa-link"></i></a>
</h2>
<p>새로운 R 스크립트 파일을 <code>functions/</code> 디렉토리에 <code>functions-lesson.R</code>
이름으로 저장하고 편집기에서 연다.</p>
<div class="sourceCode" id="cb925"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">the_sum</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">+</span> <span class="va">b</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">the_sum</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>화씨온도에서 캘빈온도로 변환하는 <code>fahr_to_kelvin()</code> 함수를 정의한다:</p>
<div class="sourceCode" id="cb926"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fahr_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">kelvin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">kelvin</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><code>function</code> 출력을 대입하는 <code>fahr_to_kelvin()</code> 함수를 정의한다.
인자 명칭 리스트는 괄호 안에 담겨진다.
다음으로 함수 <a href="%7B%7B%20page.root%20%7D%7D/reference.html#function-body">몸통부문</a>
(함수를 실행할 때 실행되는 문장)이
괄호(<code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code>) 내부에 담겨진다.
몸통부문 문장은 보통 공백 2 개로 들여쓰기한다.
들여쓰면, 코드 가독성이 높아지지만, 코드 동작에는 영향을 끼치지 않는다.</p>
<p>함수 생성을 요리책 저작하는 것처럼 생각하면 도움이된다.
먼저, 함수가 필요로 하는 “식재료(ingredient)”를 정의한다.
온도 변환기 함수에서, 함수에 사용할 식재료는 하나만 필요하다: “temp”.
식재료를 쭉 나열한 후에, 식재료로 무엇을 할지 기술한다;
이번 경우에, 식재료를 받아 일련의 수학 연산작업을 수행한다.</p>
<p>함수를 호출할 때, 함수에 전달되는 값이 변수에 대입된다.
그래서, 함수 내부에서 전달되는 값을 사용할 수 있다.
함수 내부에서 <a href="%7B%7B%20page.root%20%7D%7D/reference.html#return-statement">반환문(return)</a>을
사용해서 호출한 쪽에 결과를 되돌려준다.</p>
<div id="function-tips" class="rmdcaution">
<p><strong>꿀팁:</strong></p>
<p>R에만 있는 유일무이한 기능 하나가 반환문 <code>return</code>이 반듯이 필요하지 않다는 점이다.
R은 자동적으로 함수 몸통부문 마지막 줄에 있는 어떤 변수나 반환시킨다.
하지만 명확성을 위해서, 명시적으로 반환문 <code>return</code>을 정의한다.</p>
</div>
<p>함수를 실행해보자.
본인이 작성한 사용자 정의 함수 호출은 여타 다른 함수 호출과 차이가 없다:</p>
<div class="sourceCode" id="cb927"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 빙점</span>
<span class="fu">fahr_to_kelvin</span><span class="op">(</span><span class="fl">32</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 273</code></pre>
<div class="sourceCode" id="cb929"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 끓는 점</span>
<span class="fu">fahr_to_kelvin</span><span class="op">(</span><span class="fl">212</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 373</code></pre>
</div>
<div id="r-function-challenge-one" class="section level2" number="30.2">
<h2>
<span class="header-section-number">30.2</span> 도전과제 1<a class="anchor" aria-label="anchor" href="#r-function-challenge-one"><i class="fas fa-link"></i></a>
</h2>
<p><code>kelvin_to_celsius()</code> 함수를 작성해서 캘빈온도를 받아 섭씨온도를 반환한다.
<strong>힌트:</strong> 캘빈온도를 섭씨온도로 전환하려면, 273.15 을 뺀다.</p>
<blockquote>
<p><strong>도전과제 1에 대한 해답</strong></p>
<p><code>kelvin_to_celsius()</code> 함수를 작성해서 캘빈온도를 받아 섭씨온도를 반환한다.</p>
<div class="sourceCode" id="cb931"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kelvin_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span>
 <span class="va">celsius</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op">-</span> <span class="fl">273.15</span>
 <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">celsius</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</blockquote>
</div>
<div id="r-function-composition" class="section level2" number="30.3">
<h2>
<span class="header-section-number">30.3</span> 함수 결합<a class="anchor" aria-label="anchor" href="#r-function-composition"><i class="fas fa-link"></i></a>
</h2>
<p>함수의 진정한 힘은 원하는 효과를 얻어 내는데 함수를 섞고, 매칭하고, 결합해서
더 큰 덩어리로 구현함에 있다.</p>
<p>화씨 온도에서 캘빈 온도로, 갤빈 온도에서 섭씨 온도로 온도를 전환하는 함수 두개를 정의한다:</p>
<div class="sourceCode" id="cb932"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fahr_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">kelvin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">kelvin</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">kelvin_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">celsius</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op">-</span> <span class="fl">273.15</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">celsius</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="r-function-challenge-two" class="section level2" number="30.4">
<h2>
<span class="header-section-number">30.4</span> 도전과제 2<a class="anchor" aria-label="anchor" href="#r-function-challenge-two"><i class="fas fa-link"></i></a>
</h2>
<p>바로 위에 정의된 함수 두개를 재사용해서 화씨온도에서 바로 섭씨온도로
변환하는 함수를 정의한다.
(혹은, 본인이 원하면 자신이 직접 작성한 함수를 사용한다.)</p>
<blockquote>
<p><strong>도전과제 2에 대한 해답</strong></p>
<p>바로 위에 정의된 함수 두개를 재사용해서 화씨온도에서 바로 섭씨온도로
변환하는 함수를 정의한다.</p>
<div class="sourceCode" id="cb933"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fahr_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">temp_k</span> <span class="op">&lt;-</span> <span class="fu">fahr_to_kelvin</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span>
  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">kelvin_to_celsius</span><span class="op">(</span><span class="va">temp_k</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</blockquote>
</div>
<div id="r-function-defensive" class="section level2" number="30.5">
<h2>
<span class="header-section-number">30.5</span> 방어적 프로그래밍<a class="anchor" aria-label="anchor" href="#r-function-defensive"><i class="fas fa-link"></i></a>
</h2>
<p>R코드를 재사용가능하고 모듈화 되도록 만드는데 함수 작성이 효율적인 방법을 제공한다는 점에서 이제야
참진가를 알게 되었다. 따라서, 함수가 의도된 방식으로 동작하도록 확실히 하는 것도 매우 중요하다.
함수 매개변수(인자) 검사는 <strong>방어적 프로그래밍(defensive programming)</strong> 개념과 연관되어 있다.
방어적 프로그래밍은 자주 조건을 검사하고, 무언가 잘못되면 오류를 던지도록 장려한다.
이러한 검사를 단언문(assertion statement)라고 부른다. 왜냐하면 다음으로 넘어가기 전에
조건이 <code>TRUE</code> 사실로 단언해야 되기 때문이다.
이러한 특성이 디버깅을 더 수월하게 하는데 이유는 오류가 최초 생겨난 곳에 대해 더 나은 아이디어를
제시해 주기 때문이다.</p>
<div id="r-function-stopifnot" class="section level3" number="30.5.1">
<h3>
<span class="header-section-number">30.5.1</span> <code>stopifnot()</code> 조건 검사<a class="anchor" aria-label="anchor" href="#r-function-stopifnot"><i class="fas fa-link"></i></a>
</h3>
<p>화씨 온도를 켈빈 온도로 변환하는데 사용되는 자체 제작 함수 <code>fahr_to_kelvin()</code>을
다시 살펴보면서 시작해보자. 함수가 다음과 같이 정의되었다:</p>
<div class="sourceCode" id="cb934"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fahr_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">kelvin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">kelvin</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>함수가 의도한 대로 동작하기 위해서, <code>temp</code> 인자는 숫자형(<code>numeric</code>) 값이 되어야 한다;
그렇지 않은 경우, 온도를 변환하는 수학 연산 작업이 정상적으로 수행되지 않게 된다.
오류를 생성시키는데, <code><a href="https://rdrr.io/r/base/stop.html">stop()</a></code> 함수를 사용한다.
예를 들어, <code>temp</code> 인자는 숫자형(<code>numeric</code>) 벡터가 되어야 하는데,
<code>if</code> 문으로 조건을 검사해서 조건이 위반되면 오류를 던진다.
이를 반영하여 다음과 같이 함수 기능을 강화시킬 수 있다:</p>
<div class="sourceCode" id="cb935"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fahr_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"temp must be a numeric vector."</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">kelvin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">kelvin</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>검사할 다수 조건과 인자가 있게 되면, 이 모두를 검사하는 코드가 많이 필요하게 된다.
다행히, <code><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot()</a></code> 편의 함수가 R에서 지원된다.
<code>TRUE</code> 참으로 평가되어야 하는 요구사항을 쭉 나열한다; <code>FALSE</code> 거짓인 것이 하나
발견되면 <code><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot()</a></code> 함수는 오류를 던진다.
이러한 조건을 나열하는 것이 함수에 대한 부가 문서로서 부차적인 역할을 담당도 한다.</p>
<p><code>fahr_to_kelvin()</code> 함수의 입력값을 검사하는 단언문을 추가해서
<code><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot()</a></code> 함수로 방어적 프로그래밍을 시도해보자.</p>
<p>다음을 단언문으로 확인하자; <code>temp</code> 인자가 숫자 벡터다. 다음과 같이 코드를 작성하자:</p>
<div class="sourceCode" id="cb936"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fahr_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span>
  <span class="va">kelvin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">kelvin</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>적절한 입력이 제시되면 정상적으로 동작한다.</p>
<div class="sourceCode" id="cb937"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 빙점</span>
<span class="fu">fahr_to_kelvin</span><span class="op">(</span>temp <span class="op">=</span> <span class="fl">32</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 273</code></pre>
<p>부적절한 입력이 제시되면 즉시 실패한다.</p>
<div class="sourceCode" id="cb939"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 숫자형 대신에 문자가 주어짐.</span>
<span class="fu">fahr_to_kelvin</span><span class="op">(</span>temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fl">32</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in fahr_to_kelvin(temp = as.factor(32)): is.numeric(temp) is not TRUE</code></pre>
</div>
</div>
<div id="r-function-challenge-three" class="section level2" number="30.6">
<h2>
<span class="header-section-number">30.6</span> 도전과제 3<a class="anchor" aria-label="anchor" href="#r-function-challenge-three"><i class="fas fa-link"></i></a>
</h2>
<p>방어적 프로그래밍을 사용해서, <code>temp</code> 인자를 부적절하게 제시하게 되면
<code>fahr_to_celsius()</code> 함수가 오류를 즉시 던지도록 작성한다.</p>
<blockquote>
<p><strong>도전과제 3에 대한 해답</strong></p>
<p><code><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot()</a></code> 함수에 명시적으로 호출을 추가해서 앞서 정의한 함수를 확장시킨다.
<code>fahr_to_celsius()</code> 함수는 다른 두 함수를 조합한 것이라서,
두번째 함수에도 검사를 추가하는 것은 중복이 된다.</p>
<div class="sourceCode" id="cb941"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fahr_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span>
  <span class="va">temp_k</span> <span class="op">&lt;-</span> <span class="fu">fahr_to_kelvin</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span>
  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">kelvin_to_celsius</span><span class="op">(</span><span class="va">temp_k</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</blockquote>
</div>
<div id="r-function-composition-more" class="section level2" number="30.7">
<h2>
<span class="header-section-number">30.7</span> 함수조합<a class="anchor" aria-label="anchor" href="#r-function-composition-more"><i class="fas fa-link"></i></a>
</h2>
<p>이제 데이터셋에서 한 국가에 대한 국내총생산(GDP)를 계산하는 함수를 작성한다:</p>
<div class="sourceCode" id="cb942"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 데이터셋을 인자로 받아, 1인당 GDP 칼럼과 인구수 칼럼을 곱한다.</span>
<span class="va">calcGDP</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">gdp</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">pop</span> <span class="op">*</span> <span class="va">dat</span><span class="op">$</span><span class="va">gdpPercap</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gdp</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><code>function</code> 출력을 대입하는 <code>calcGDP()</code> 함수를 정의한다.
인자 명칭 리스트는 괄호 안에 담겨진다.
다음으로 함수 몸통부문
(함수를 실행할 때 실행되는 문장)이
괄호(<code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code>) 내부에 담겨진다.</p>
<p>몸통부문 문장을 공백 2 개로 들여쓰기한다.
들여쓰면, 코드 가독성이 높아지지만, 코드 동작에는 영향을 끼치지 않는다.</p>
<p>함수를 호출할 때, 함수에 전달되는 값이 인자에 대입된다.
전달되는 값은 함수 몸통 내부에서 변수가 된다.</p>
<p>함수 내부에서, <code><a href="https://rdrr.io/r/base/function.html">return()</a></code> 함수를 사용해서 결과를 함수밖으로 배출한다.
반환 <code><a href="https://rdrr.io/r/base/function.html">return()</a></code> 함수는 선택옵션이다:
R은 자동으로 함수 마지막 줄에 실행되는 어떤 명령어든 결과를 반환한다.</p>
<div class="sourceCode" id="cb943"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">calcGDP</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 6.57e+09 7.59e+09 8.76e+09 9.65e+09 9.68e+09 1.17e+10</code></pre>
<p>그다지 유용한 정보는 아니다.
인자를 일부 추가해서 연도별, 국가별 GDP를 추출한다.</p>
<div class="sourceCode" id="cb945"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 데이터셋을 인자로 받아, 1인당 GDP 칼럼과 인구수 칼럼을 곱한다.</span>
<span class="va">calcGDP</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span>, <span class="va">year</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">country</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">year</span>, <span class="op">]</span>
  <span class="op">}</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">country</span>,<span class="op">]</span>
  <span class="op">}</span>
  <span class="va">gdp</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">pop</span> <span class="op">*</span> <span class="va">dat</span><span class="op">$</span><span class="va">gdpPercap</span>

  <span class="va">new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">dat</span>, gdp<span class="op">=</span><span class="va">gdp</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>별도 R 스크립트 파일에 상기 함수를 작성했다면(좋은 아이디어!), <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> 함수를
사용해서 R 세션에 함수를 올려 적재할 수 있다:</p>
<div class="sourceCode" id="cb946"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"functions/functions-lesson.R"</span><span class="op">)</span></code></pre></div>
<p>이제 함수에 상당히 많은 일을 하고 있네요.
쉬운 말로 풀어쓰면, 연도 <code>year</code> 인자가 비어있지 않는다면,
함수가 전달된 연도 정보로 부분집합 데이터를 생성하고 나서,
국가 <code>country</code> 인자가 비어있지 않는다면,
함수가 전달된 국가 정보로 부분집합 데이터를 생성한다.
그리고 나서, 연도와 국가 인자에서 추출된 부분집합에 대해
GDP를 계산한다.
그리고 나서, 함수가 GDP를 신규 칼럼으로 추가해서 부분집합으로 뽑아낸 데이터셋에서
추가하고 최종 결과로 반환한다.
숫자 벡터로 쭉 뽑혀진 것보다 출력결과가 훨씬 더 유용한 정보를 제공함을 알 수 있다.</p>
<p>연도를 인자로 명세할 때 어떤 일이 발생하는지 살펴보자:</p>
<div class="sourceCode" id="cb947"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span>, year<span class="op">=</span><span class="fl">2007</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##        country year      pop continent lifeExp gdpPercap      gdp
## 12 Afghanistan 2007 31889923      Asia    43.8       975 3.11e+10
## 24     Albania 2007  3600523    Europe    76.4      5937 2.14e+10
## 36     Algeria 2007 33333216    Africa    72.3      6223 2.07e+11
## 48      Angola 2007 12420476    Africa    42.7      4797 5.96e+10
## 60   Argentina 2007 40301927  Americas    75.3     12779 5.15e+11
## 72   Australia 2007 20434176   Oceania    81.2     34435 7.04e+11</code></pre>
<p>혹은 특정 국가를 인자로 전달하면 어떻게 되는지 살펴보자:</p>
<div class="sourceCode" id="cb949"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span>, country<span class="op">=</span><span class="st">"Australia"</span><span class="op">)</span></code></pre></div>
<pre><code>##      country year      pop continent lifeExp gdpPercap      gdp
## 61 Australia 1952  8691212   Oceania    69.1     10040 8.73e+10
## 62 Australia 1957  9712569   Oceania    70.3     10950 1.06e+11
## 63 Australia 1962 10794968   Oceania    70.9     12217 1.32e+11
## 64 Australia 1967 11872264   Oceania    71.1     14526 1.72e+11
## 65 Australia 1972 13177000   Oceania    71.9     16789 2.21e+11
## 66 Australia 1977 14074100   Oceania    73.5     18334 2.58e+11
## 67 Australia 1982 15184200   Oceania    74.7     19477 2.96e+11
## 68 Australia 1987 16257249   Oceania    76.3     21889 3.56e+11
## 69 Australia 1992 17481977   Oceania    77.6     23425 4.10e+11
## 70 Australia 1997 18565243   Oceania    78.8     26998 5.01e+11
## 71 Australia 2002 19546792   Oceania    80.4     30688 6.00e+11
## 72 Australia 2007 20434176   Oceania    81.2     34435 7.04e+11</code></pre>
<p>혹은, 연도와 국가를 모두 인자로 전달하면 어떻게 되는지 살펴보자:</p>
<div class="sourceCode" id="cb951"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span>, year<span class="op">=</span><span class="fl">2007</span>, country<span class="op">=</span><span class="st">"Australia"</span><span class="op">)</span></code></pre></div>
<pre><code>##      country year      pop continent lifeExp gdpPercap      gdp
## 72 Australia 2007 20434176   Oceania    81.2     34435 7.04e+11</code></pre>
<p>함수 몸통부문을 살펴본다:</p>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="r-function.html#cb953-1" aria-hidden="true" tabindex="-1"></a>calcGDP <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, <span class="at">year=</span><span class="cn">NULL</span>, <span class="at">country=</span><span class="cn">NULL</span>) {</span></code></pre></div>
<p>위에서 인자 두개 <code>year</code>, <code>country</code>를 추가했다.
함수 정의부에서 <em>기본디폴트 인자</em>를 모두 <code>=</code> 연산자를 사용해서 <code>NULL</code>로 설정했다.
이것이 의미하는 바는 사용자가 달리 인자를 설정하지 않는다면,
각 인자에 <code>NULL</code> 값을 인자로 넘기게 된다.</p>
<div class="sourceCode" id="cb954"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">year</span>, <span class="op">]</span>
  <span class="op">}</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">country</span>,<span class="op">]</span>
  <span class="op">}</span></code></pre></div>
<p>여기서, 각기 추가되는 인자가 <code>null</code> 로 설정되었는지 검사한다.
<code>null</code> 이 아닌 경우, <code>null</code>이 아닌 인자로 부분집합 데이터로 뽑아내려고
<code>dat</code>에 저장된 데이터셋을 덮어쓴다.</p>
<p>추후에 좀더 유연하게 함수를 작성할 예정이다.
따라서, GDP를 다음 질문에 대해 답할 수 있다:</p>
<ul>
<li>전체 데이터셋;</li>
<li>단일 연도;</li>
<li>단일 국가;</li>
<li>단일 연도와 단일국가 조합.</li>
</ul>
<p>대신에 <code>%in%</code> 연산자를 사용해서, 여러 연도와 국가를 인자에 넘길 수 있다.</p>
<div id="r-function-pass-by-value" class="rmdcaution">
<p><strong>꿀팁: 값에 의한 전달</strong></p>
<p>R에 함수는 거의 항상 데이터 사본을 생성해서 함수 몸통 내부에서<br>
연산 작업을 수행한다.
함수 내부 <code>dat</code> 데이터를 변경할 때,
첫 인자로 전달한 원본 데이터가 아닌 <code>dat</code>에 저장된 <code>gapminder</code> 데이터셋
사본을 조작하는 것이다.</p>
<p>이를 “값에 의한 전달(pass-by-value)” 라고 부르며,
코드 작성을 훨씬 더 안전하게 한다:
함수 몸통부문 내부에서 어떤 변경을 하든, 함수 몸통부문에 한정된 것이라는 것을
항상 확실히 할 수 있다.</p>
</div>
<div id="r-function-scope" class="rmdcaution">
<p><strong>꿀팁: 함수 유효범위(Function scope)</strong></p>
<p>또한가지 중요한 개념이 유효범위(scoping)다:
함수 몸통부문 내부에서 생성하거나 변경한 어떤 변수(혹은 함수!)는
함수 실행 기간동안만 존재한다.
<code>calcGDP</code> 함수를 호출할 때, 변수 <code>dat</code>,
<code>gdp</code>, <code>new</code>는 함수 몸통 내부에서만 존재한다.
설사 인터랙티브 세션에서 동일한 명칭을 갖는 변수가 있더라도,
함수가 시행될 때, 어떤 방식으로도 변경되지 않는다.</p>
</div>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="r-function.html#cb955-1" aria-hidden="true" tabindex="-1"></a>  gdp <span class="ot">&lt;-</span> dat<span class="sc">$</span>pop <span class="sc">*</span> dat<span class="sc">$</span>gdpPercap</span>
<span id="cb955-2"><a href="r-function.html#cb955-2" aria-hidden="true" tabindex="-1"></a>  new <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dat, <span class="at">gdp=</span>gdp)</span>
<span id="cb955-3"><a href="r-function.html#cb955-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(new)</span>
<span id="cb955-4"><a href="r-function.html#cb955-4" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<p>마지막으로, 신규 부분집합 데이터셋에 GDP를 계산하고,
신규 데이터프레임을 생성하고 동일한 명칭을 갖는 칼럼을 추가한다.
즉, 나중에 함수를 호출할 때, 반환된 GDP 값에 대한 맥락을 찾아볼 수 있다는 것이다.
앞서 숫자 벡터보다 이런 점에서 훨씬 더 낫다.</p>
</div>
<div id="r-function-challenge-four" class="section level2" number="30.8">
<h2>
<span class="header-section-number">30.8</span> 도전과제 4<a class="anchor" aria-label="anchor" href="#r-function-challenge-four"><i class="fas fa-link"></i></a>
</h2>
<p>1987년 뉴질랜드 GPD를 계산하도록 GDP 함수를 테스트한다.
1952년 뉴질랜드 GDP와 얼마나 차이날까?</p>
<blockquote>
<p><strong>도전과제 4에 대한 해답</strong></p>
<div class="sourceCode" id="cb956"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span>, year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1952</span>, <span class="fl">1987</span><span class="op">)</span>, country <span class="op">=</span> <span class="st">"New Zealand"</span><span class="op">)</span></code></pre></div>
<p>1987년 뉴질랜드 GDP: 65050008703</p>
<p>1952년 뉴질랜드 GDP: 21058193787</p>
</blockquote>
</div>
<div id="r-function-challenge-five" class="section level2" number="30.9">
<h2>
<span class="header-section-number">30.9</span> 도전과제 5<a class="anchor" aria-label="anchor" href="#r-function-challenge-five"><i class="fas fa-link"></i></a>
</h2>
<p><code>paste</code> 함수를 사용해서 텍스트를 결합할 수 있다, 즉:</p>
<div class="sourceCode" id="cb957"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">best_practice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Write"</span>, <span class="st">"programs"</span>, <span class="st">"for"</span>, <span class="st">"people"</span>, <span class="st">"not"</span>, <span class="st">"computers"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">best_practice</span>, collapse<span class="op">=</span><span class="st">" "</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Write programs for people not computers"</code></pre>
<p><code>text</code> 와 <code>wrapper</code>라는 벡터 인자 두개를 받는 <code>fence</code>라는 함수를 작성한다.
함수는 <code>wrapper</code>로 둘러싼 텍스트를 출력한다:</p>
<div class="sourceCode" id="cb959"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">fence</span><span class="op">(</span>text<span class="op">=</span><span class="va">best_practice</span>, wrapper<span class="op">=</span><span class="st">"***"</span><span class="op">)</span></code></pre></div>
<p><em>주목:</em> <code>paste</code> 함수는 <code>sep</code> 라는 인자를 갖는데,
<code>sep</code> 인자는 텍스트 사이 구분자를 명세한다.
기본디폴트 설정은 공백이다: ” “. <code>paste0</code> 함수에 대한 기본디폴트 설정은 공백이 없음이다:”“.</p>
<blockquote>
<p><strong>도전과제 5에 대한 해답</strong></p>
<p><code>text</code> 와 <code>wrapper</code>라는 벡터 인자 두개를 받는 <code>fence</code>라는 함수를 작성한다.
함수는 <code>wrapper</code>로 둘러싼 텍스트를 출력한다:</p>
<div class="sourceCode" id="cb960"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">text</span>, <span class="va">wrapper</span><span class="op">)</span><span class="op">{</span>
  <span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">wrapper</span>, <span class="va">text</span>, <span class="va">wrapper</span><span class="op">)</span>
  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">text</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">best_practice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Write"</span>, <span class="st">"programs"</span>, <span class="st">"for"</span>, <span class="st">"people"</span>, <span class="st">"not"</span>, <span class="st">"computers"</span><span class="op">)</span>
<span class="fu">fence</span><span class="op">(</span>text<span class="op">=</span><span class="va">best_practice</span>, wrapper<span class="op">=</span><span class="st">"***"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "*** Write programs for people not computers ***"</code></pre>
</blockquote>
<div id="r-function-manual" class="rmdcaution">
<p><strong>꿀팁:</strong></p>
<p>더 복잡한 연산작업을 수행할 때, 정말 잘 활용될 수 있는 R에만 있는 유일무이한 기능이 있다.
이러한 고급 개념으로 무장한 함수는 작성하지 않을 것이다.
향후, R로 함수를 작성하는데 무리가 없다면,
<a href="http://cran.r-project.org/doc/manuals/r-release/R-lang.html#Environment-objects">R Language Manual</a>과 Hadley Wickham 저서 <a href="http://adv-r.had.co.nz/">Advanced R Programming</a>
책에 포함된 <a href="http://adv-r.had.co.nz/Environments.html">환경</a>을 참조한다.
R은 프레임(frame) 대신에 “환경(environment)”을 용어로 사용한다.</p>
</div>
<div id="r-function-testing" class="rmdcaution">
<p><strong>꿀팁: 테스트와 문서화</strong></p>
<p>함수를 테스트하고 문서화하는 것 모두 중요하다:
문서화를 하게 되면 여러분과 다른 독자가 작성된 함수 목적과
사용법을 이해하는데 도움이 된다.</p>
<p>작성된 함수가 생각한 대로 실제로 동작하는지 확실히 하는 것도 중요하다.
처음 시작할 때, 작업흐름은 아마도 다음과 같다:</p>
<ol style="list-style-type: decimal">
<li>함수를 작성한다.</li>
<li>함수 일부에 동작을 문서화하는 주석을 단다.</li>
<li>소스 파일에 적재해서 불러온다.</li>
<li>콘솔에서 예상한 대로 동작을 확인하는 실험을 한다.</li>
<li>필요한 버그를 제거한다.</li>
<li>깔끔하게 하고, 상기 과정을 반복한다.</li>
</ol>
<p>함수에 대한 공식 문서는 별도 <code>.Rd</code> 파일에 작성되는데,
도움말 파일에서 보게 되는 문서로 변환된다.</p>
<p><a href="http://cran.r-project.org/web/packages/roxygen2/vignettes/rd.html">roxygen2</a> 팩키지는 R 프로그래머가 함수 코드와 함께 문서를
작성하게 돕고, 이 파일을 처리하게 되면 적절한 <code>.Rd</code> 파일로 떨군다.
더 복잡한 R 프로젝트 코드를 작성할 때,
문서를 작성하는 공식적인 방법으로 전환하면 된다.
공식 자동화 테스트는 <a href="http://r-pkgs.had.co.nz/tests.html">testthat</a> 팩키지를 사용해서 작성된다.</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="r-vectorization.html"><span class="header-section-number">29</span> 벡터화(Vectorization)</a></div>
<div class="next"><a href="r-writing.html"><span class="header-section-number">31</span> 데이터 저장</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#r-function"><span class="header-section-number">30</span> 함수 설명</a></li>
<li><a class="nav-link" href="#r-funciton-definition"><span class="header-section-number">30.1</span> 함수 정의하기</a></li>
<li><a class="nav-link" href="#r-function-challenge-one"><span class="header-section-number">30.2</span> 도전과제 1</a></li>
<li><a class="nav-link" href="#r-function-composition"><span class="header-section-number">30.3</span> 함수 결합</a></li>
<li><a class="nav-link" href="#r-function-challenge-two"><span class="header-section-number">30.4</span> 도전과제 2</a></li>
<li>
<a class="nav-link" href="#r-function-defensive"><span class="header-section-number">30.5</span> 방어적 프로그래밍</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#r-function-stopifnot"><span class="header-section-number">30.5.1</span> stopifnot() 조건 검사</a></li></ul>
</li>
<li><a class="nav-link" href="#r-function-challenge-three"><span class="header-section-number">30.6</span> 도전과제 3</a></li>
<li><a class="nav-link" href="#r-function-composition-more"><span class="header-section-number">30.7</span> 함수조합</a></li>
<li><a class="nav-link" href="#r-function-challenge-four"><span class="header-section-number">30.8</span> 도전과제 4</a></li>
<li><a class="nav-link" href="#r-function-challenge-five"><span class="header-section-number">30.9</span> 도전과제 5</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>데이터 과학을 지탱하는 기본기</strong>" was written by 한국 알 사용자회. It was last built on 2022-05-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
